<article xmlns:ali="http://www.niso.org/schemas/ali/1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article">
  <?properties open_access?>
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
      <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="pmc">plosone</journal-id>
      <journal-title-group>
        <journal-title>PLoS ONE</journal-title>
      </journal-title-group>
      <issn pub-type="epub">1932-6203</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, CA USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmid">26075402</article-id>
      <article-id pub-id-type="pmc">4467979</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pone.0129745</article-id>
      <article-id pub-id-type="publisher-id">PONE-D-14-46569</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>'SEEDY' (Simulation of Evolutionary and Epidemiological Dynamics): An R Package to Follow Accumulation of Within-Host Mutation in Pathogens</article-title>
        <alt-title alt-title-type="running-head">Simulation of Evolutionary and Epidemiological Dynamics in R</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Worby</surname>
            <given-names>Colin J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff001">
            <sup>1</sup>
          </xref>
          <xref rid="cor001" ref-type="corresp">*</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Read</surname>
            <given-names>Timothy D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff002">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff003">
            <sup>3</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff001">
        <label>1</label>
        <addr-line>Center for Communicable Disease Dynamics, Department of Epidemiology, Harvard T. H. Chan School of Public Health, Boston, MA, United States of America</addr-line>
      </aff>
      <aff id="aff002">
        <label>2</label>
        <addr-line>Department of Medicine, Division of Infectious Diseases, Emory University School of Medicine, Atlanta, GA, United States of America</addr-line>
      </aff>
      <aff id="aff003">
        <label>3</label>
        <addr-line>Department of Human Genetics, Emory University School of Medicine, Atlanta, GA, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor">
          <name>
            <surname>Nishiura</surname>
            <given-names>Hiroshi</given-names>
          </name>
          <role>Academic Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>The University of Tokyo, JAPAN</addr-line>
      </aff>
      <author-notes>
        <fn fn-type="conflict" id="coi001">
          <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con" id="contrib001">
          <p>Performed the experiments: CJW. Wrote the paper: CJW TDR. Conceived and designed the software package: CJW. Wrote and tested code: CJW TDR.</p>
        </fn>
        <corresp id="cor001">* E-mail: <email>cworby@hsph.harvard.edu</email></corresp>
      </author-notes>
      <pub-date pub-type="epub">
        <day>15</day>
        <month>6</month>
        <year>2015</year>
      </pub-date>
      <pub-date pub-type="collection">
        <year>2015</year>
      </pub-date>
      <volume>10</volume>
      <issue>6</issue>
      <elocation-id>e0129745</elocation-id>
      <history>
        <date date-type="received">
          <day>16</day>
          <month>10</month>
          <year>2014</year>
        </date>
        <date date-type="accepted">
          <day>12</day>
          <month>5</month>
          <year>2015</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2015</copyright-year>
        <copyright-holder>Worby, Read</copyright-holder>
        <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
          <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
        </license>
      </permissions>
      <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0129745.pdf"/>
      <abstract>
        <p>Genome sequencing is an increasingly common component of infectious disease outbreak investigations. However, the relationship between pathogen transmission and observed genetic data is complex, and dependent on several uncertain factors. As such, simulation of pathogen dynamics is an important tool for interpreting observed genomic data in an infectious disease outbreak setting, in order to test hypotheses and to explore the range of outcomes consistent with a given set of parameters. We introduce <italic>‘seedy’</italic>, an R package for the simulation of evolutionary and epidemiological dynamics (<ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/seedy/">http://cran.r-project.org/web/packages/seedy/</ext-link>). Our software implements stochastic models for the accumulation of mutations within hosts, as well as individual-level disease transmission. By allowing variables such as the transmission bottleneck size, within-host effective population size and population mixing rates to be specified by the user, our package offers a flexible framework to investigate evolutionary dynamics during disease outbreaks. Furthermore, our software provides theoretical pairwise genetic distance distributions to provide a likelihood of person-to-person transmission based on genomic observations, and using this framework, implements transmission route assessment for genomic data collected during an outbreak. Our open source software provides an accessible platform for users to explore pathogen evolution and outbreak dynamics via simulation, and offers tools to assess observed genomic data in this context.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work was supported by the National Institute of General Medical Sciences of the National Institutes of Health under award number U54GM088558. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institute of General Medical Sciences or the National Institutes of Health. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <fig-count count="7"/>
        <table-count count="0"/>
        <page-count count="14"/>
      </counts>
      <custom-meta-group>
        <custom-meta id="data-availability">
          <meta-name>Data Availability</meta-name>
          <meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
        </custom-meta>
      </custom-meta-group>
    </article-meta>
  </front>
  <body>
    <sec sec-type="intro" id="sec001">
      <title>Introduction</title>
      <p>Falling costs and technological advances have resulted in whole genome sequencing becoming increasingly common in the study of disease outbreaks [<xref rid="pone.0129745.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0129745.ref004" ref-type="bibr">4</xref>]. In recent years, several studies have used such data to investigate both within-host evolutionary dynamics [<xref rid="pone.0129745.ref005" ref-type="bibr">5</xref>] and individual level routes of disease transmission [<xref rid="pone.0129745.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0129745.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0129745.ref007" ref-type="bibr">7</xref>]. However, the interpretation of observed genomic data to determine person-to-person transmission is challenging. Several aspects of infectious disease dynamics, such as the size of both the inoculum and the pathogen population in the host, are not yet fully understood. As such, many studies of disease transmission routes rely on restrictive or unrealistic assumptions, such as mutation occurring only at the moment of transmission [<xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0129745.ref009" ref-type="bibr">9</xref>], or that infectious contact involves the transmission of a single genotype [<xref rid="pone.0129745.ref010" ref-type="bibr">10</xref>]. Furthermore, a lack of repeated sampling has resulted in several studies ignoring the potential for within-host diversity and representing infected cases by a single genotype. Simulation of genomic data during an outbreak is therefore a valuable way to explore the range of potential outcomes for given parameter values and sampling strategies, to investigate the accumulation of mutation both within and between hosts, as well as to test hypotheses about transmission routes and evolutionary dynamics.</p>
      <p>Simulation of sequence data from a disease outbreak presents a challenge, since this represents sampling from multiple, independently evolving within-host pathogen populations. While it may suffice to neglect the effect of within-host dynamics when considering evolutionary dynamics on a population level [<xref rid="pone.0129745.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0129745.ref012" ref-type="bibr">12</xref>], it is frequently of interest to study microevolution in the context of individual level disease transmission [<xref rid="pone.0129745.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0129745.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0129745.ref013" ref-type="bibr">13</xref>]. In such a setting, the generation of diversity within-host, and the stochastic effects of sampling and genotypes transmitted onward are of much importance. The study of transmission network reconstruction has flourished in recent years [<xref rid="pone.0129745.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0129745.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0129745.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0129745.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0129745.ref015" ref-type="bibr">15</xref>], with the aim of identifying who infected whom in a small outbreak. Testing the performance of such approaches requires a realistic model of within-host evolution and transmission. While R packages exist to simulate epidemic dynamics [<xref rid="pone.0129745.ref016" ref-type="bibr">16</xref>] and sequence data [<xref rid="pone.0129745.ref017" ref-type="bibr">17</xref>], as well as genomic data during an epidemic with no within-host diversity [<xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>], a framework to generate realistic individual-level evolutionary and epidemiological data is still lacking.</p>
      <p>We developed ‘<italic>seedy’</italic> (Simulation of Evolutionary and Epidemiological DYnamics) in order to provide a set of functions to simulate and visualize these dynamics, allowing flexible specification of both pathogen- and host-level variables. Genomic data can be simulated according to a variety of sampling strategies, with the option of sampling single genomes, or deep-sequence observations.</p>
      <p>In addition, the package contains functions to describe the theoretical distribution of genetic distances between samples taken during a disease outbreak, under a range of assumptions. This can allow for the investigation of transmission routes, as well as the specification of a distance threshold, above which direct transmission between sampled hosts may be ruled out to a given probability level. Such a threshold is often chosen arbitrarily in studies [<xref rid="pone.0129745.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0129745.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0129745.ref019" ref-type="bibr">19</xref>], and a more formal approach to choosing such values is likely of much interest to outbreak investigation teams and epidemiologists.</p>
      <p>Our software is open-source, and freely available on the cross-platform statistical computing environment R [<xref rid="pone.0129745.ref020" ref-type="bibr">20</xref>], and can be downloaded from the Comprehensive R Archive Network (CRAN) [<xref rid="pone.0129745.ref021" ref-type="bibr">21</xref>]. Our software is designed to be accessible to a range of users, with detailed help files for each function, and no high-level programming skills required. Exporting simulated data to NEXUS [<xref rid="pone.0129745.ref022" ref-type="bibr">22</xref>] or FASTA formats allows compatibility and subsequent analysis in a range of R packages, as well as other programs.</p>
    </sec>
    <sec sec-type="materials|methods" id="sec002">
      <title>Materials and Methods</title>
      <p>Our package contains two main simulation functions; simulatepopulation() and simulateoutbreak(), upon which many of the other functions depend. The former simulates a single population over a specified length of time, potentially undergoing repeated population bottleneck events. The latter simulates pathogen evolution during a disease outbreak, in which new, independent pathogen populations are created within individuals upon infection, seeded by a random sample from their infector. The package (version 1.2) and example code are included in <xref rid="pone.0129745.s004" ref-type="supplementary-material">S1 File</xref>.</p>
      <sec id="sec003">
        <title>Single population simulation</title>
        <p>The simulatepopulation() function allows the simulation of pathogen evolutionary dynamics in a single population under a discrete-time stochastic growth model. Pathogen population size is by default assumed to grow from an initial size of 1 to a specified equilibrium level, <italic>N</italic><sub><italic>eq</italic></sub>, with a per-generation death probability at time <italic>t</italic> of <italic>N</italic>(<italic>t</italic>) / 2<italic>N</italic><sub><italic>eq</italic></sub>, where <italic>N</italic>(<italic>t</italic>) is the current population size. The next generation population of each particular genotype <italic>N</italic><sub><italic>g</italic></sub>(<italic>t</italic> + 1) is thus drawn from a Bin(<italic>N</italic><sub><italic>g</italic></sub>(<italic>t</italic>), <italic>N</italic>(<italic>t</italic> – 1) / (2<italic>N</italic><sub><italic>eq</italic></sub>)) distribution. While population extinction is unlikely for large <italic>N</italic><sub><italic>eq</italic></sub>, this possibility is prevented by selecting one genotype at random to persist if <italic>N</italic><sub><italic>g</italic></sub>(<italic>t</italic> + 1) = 0 for all genotypes <italic>g</italic>. By default, <italic>N</italic><sub><italic>eq</italic></sub> is constant over time, however, a user-defined function may be input as the ‘shape’ argument to allow for alternative within-host population growth models. Under this model, the effective population size <italic>N</italic><sub><italic>e</italic></sub> at time <italic>t</italic> will be <italic>N</italic>(<italic>t</italic>) / 2.</p>
        <p>Neutral mutations are introduced at rate <italic>μ</italic>, and a nucleotide position is selected uniformly at random for mutation under a Jukes-Cantor model. Backwards mutation is possible, although this is highly unlikely unless a short genome length is specified. Population bottlenecks may be implemented at specified times, in which a random sample of <italic>N</italic><sub><italic>B</italic></sub> pathogens are selected and continue to grow and mutate in future generations.</p>
        <p>Sampling times may be specified, at which one or more isolates are sampled from the population at random. By specifying ‘full’ sampling in simulatepopulation(), a list of all unique extant genotypes, along with their frequencies, is recorded at each specified sampling time.</p>
      </sec>
      <sec id="sec004">
        <title>Epidemic simulation</title>
        <p>The function simulateoutbreak() can simulate the above pathogen dynamics together with a stochastic susceptible-infectious-removed (SIR) epidemic model [<xref rid="pone.0129745.ref023" ref-type="bibr">23</xref>], independently simulating the pathogen populations within each host. This works on the same discrete time scale as within-host dynamics, allowing epidemic dynamics to update at the same intervals as pathogen generation times. Outbreaks are initiated with the introduction of a single infectious individual, by default infected with a single genotype, into a completely susceptible population. The transmission rate to each susceptible individual at time <italic>t</italic> is given by <italic>βI</italic>(<italic>t</italic>), where <italic>β</italic> is the rate of transmission, and <italic>I</italic>(<italic>t</italic>) is the number of infectious individuals present at time <italic>t</italic>. If a susceptible individual becomes infected, an infection source is chosen at random from the <italic>I</italic>(<italic>t</italic>) currently infected people, and the new infection is initiated with an inoculum of size <italic>N</italic><sub><italic>B</italic></sub>, chosen at random from the pathogen population within the source. Infected individuals recover at rate <italic>γ</italic>, with the infectious period drawn from a Poisson distribution. The outbreak terminates when no infected individuals remain. A minimum outbreak size can be specified, such that outbreaks are repeatedly simulated until one reaches the required size.</p>
        <p>By default, individuals in the population are assumed to mix homogenously, but heterogeneous mixing may be specified in the simulateoutbreak() function using the ‘nmat’ argument. This is a contact matrix, giving the relative rate at which each individual contacts each other individual in the population. This allows the specification of a range of scenarios, such as multiple subpopulations with low between-group mixing, or the incorporation of superspreaders, individuals with a contact rate much higher than the rest of the population. Since homogeneous mixing is often an unrealistic assumption [<xref rid="pone.0129745.ref024" ref-type="bibr">24</xref>], this feature allows greater complexity to be incorporated into a simulated population structure. In this setting, the hazard for a particular susceptible individual <italic>i</italic> to become infected at time <italic>t</italic> is given by
<disp-formula id="pone.0129745.e001"><alternatives><graphic xlink:href="pone.0129745.e001.jpg" id="pone.0129745.e001g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>w</italic><sub><italic>i</italic>,<italic>k</italic></sub> gives the relative rate at which individual <italic>i</italic> comes into contact with individual <italic>k</italic>, and <italic>C</italic><sub><italic>t</italic></sub> is the set of infected individuals at time <italic>t</italic>.</p>
        <p>Various sampling strategies can be employed to generate genomic observations from the population. The argument ‘samp.schedule’ can be set to ‘calendar’, ‘individual’, or ‘random’. If ‘calendar’ is specified, one can further specify (with the argument ‘samp.freq’) the regular interval at which samples are collected, such that all infected individuals present at each sampling time are sampled. The ‘individual’ sampling schedule generates samples from infected individuals at regular intervals after their infection time. Finally, ‘random’ sampling allows each individual to have a single sampling time drawn at random from their infectious period.The simfixoutbreak() function can be used to simulation evolutionary dynamics on a fixed transmission tree. This allows investigators who are interested in more complex epidemic models to generate genomic samples on top of their own simulated transmission trees, by passing infection and removal times, and routes of infection, to the function. The specified transmission tree need not be fully connected–that is, cases from outside the community may be imported. The genotype assigned to imported individuals is generated by introducing <italic>x</italic> ∼ Pois(<italic>λ</italic>) SNPs relative to the reference genome assigned to the initial community case, with <italic>λ</italic> specified in calling the function.</p>
      </sec>
      <sec id="sec005">
        <title>Data formatting</title>
        <p>Our package requires the generation and storage of whole genome sequence data, which involves the manipulation of large data objects. In order to minimize data storage and improve simulation efficiency, full genome sequences are not retained. Instead, at any given time in the simulation, the pathogen population within each host is represented by a vector of genome IDs and their frequencies. The genome ID corresponds to an entry in a library object, which lists the position and type of single nucleotide polymorphisms, relative to an initial reference genome (<xref rid="pone.0129745.g001" ref-type="fig">Fig 1</xref>). As such, each genotype is defined by a vector of SNP positions, and the nucleotides at those positions. Only genotypes which are currently present, and those that have been previously sampled, are retained, all other entries are removed upon extinction. Output from the simulation functions contains a library object together with a corresponding vector of genotype IDs, which is sufficient to calculate pairwise genetic distances. Output may be converted back to full sequences using the librtoDNA() function, which allows sampled genomes to be returned as a character vector or matrix, or to be saved to a NEXUS or FASTA file for use in other programs or packages (eg. BEAST [<xref rid="pone.0129745.ref025" ref-type="bibr">25</xref>], PAUP [<xref rid="pone.0129745.ref026" ref-type="bibr">26</xref>], ape [<xref rid="pone.0129745.ref027" ref-type="bibr">27</xref>]).</p>
        <fig id="pone.0129745.g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g001</object-id>
          <label>Fig 1</label>
          <caption>
            <title>Raw sequence data and its storage in <italic>seedy</italic>.</title>
            <p>The ‘libr’ object stores the position of the mutant nucleotide, while the ‘nuc’ object lists the type of mutation.</p>
          </caption>
          <graphic xlink:href="pone.0129745.g001"/>
        </fig>
      </sec>
      <sec id="sec006">
        <title>Theoretical distributions</title>
        <p>Under neutral evolution, the genetic distance between two haploid isolates with a most recent common ancestor is approximated by a Pois(2<italic>μ</italic>(<italic>t</italic><sub>1</sub> + <italic>t</italic><sub>2</sub>)) distribution, where <italic>μ</italic> is the per-sequence mutation rate, <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> are the times from the ancestor to isolate observations. Typically, however, the time of the most recent common ancestor is unknown. It can be shown that the genetic distance distribution can be approximated by a geometric-Poisson mixture distribution, with the geometric component describing the diversity accumulating since the lineage divergence under the assumption of constant coalescent rate [<xref rid="pone.0129745.ref028" ref-type="bibr">28</xref>]. <xref rid="pone.0129745.g002" ref-type="fig">Fig 2</xref> depicts an example transmission chain, with two sampled pathogen isolates. The total number of mutations accumulating in the time period <italic>t</italic><sub><italic>x</italic></sub> + <italic>t</italic><sub><italic>y</italic></sub> follows a Pois(<italic>μ</italic>(<italic>t</italic><sub><italic>x</italic></sub> + <italic>t</italic><sub><italic>y</italic></sub>)) distribution, while the number of SNPs arising prior to lineage divergence <italic>D</italic>(<italic>x</italic>, <italic>y</italic>) follows a Geom(1 / (1 + 2<italic>Nμ</italic>)) distribution, where <italic>N</italic> is the effective population size, assumed to be constant [<xref rid="pone.0129745.ref029" ref-type="bibr">29</xref>].</p>
        <fig id="pone.0129745.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Disease transmission and pathogen lineages.</title>
            <p>Each rectangle represents an infected host over time, from infection to recovery, while arrows indicate transmission. Two pathogen isolates, marked as blue and red circles, are sampled at times <italic>s</italic><sub><italic>x</italic></sub> and <italic>s</italic><sub><italic>y</italic></sub>, and share a most recent common ancestor <italic>A</italic>(<italic>x</italic>, <italic>y</italic>), marked as a purple circle. Lineages diverge at time <italic>D</italic>(<italic>x</italic>, <italic>y</italic>), after which they exist independently in different hosts. With a transmission bottleneck of size 1, the most recent common ancestor must be found within the host highlighted in bold, however in general, multiple lineages may be passed between hosts. The time from coalescence to lineage divergence, <italic>w</italic>, is exponentially distributed, assuming a constant effective population size. The number of mutations arising during this unknown period follows a geometric distribution, while the total occurring after lineage divergence <italic>D</italic>(<italic>x</italic>, <italic>y</italic>) follows a Poisson distribution.</p>
          </caption>
          <graphic xlink:href="pone.0129745.g002"/>
        </fig>
      </sec>
    </sec>
    <sec sec-type="results" id="sec007">
      <title>Results</title>
      <sec id="sec008">
        <title>Simulation visualization</title>
        <p>Output from the two simulation functions described in the methods can be visualized with various tools in the software package. <xref rid="pone.0129745.g003" ref-type="fig">Fig 3</xref> shows the simulated mean diversity of an example population undergoing two bottlenecks. Diversity is measured as the expected number of single nucleotide polymorphisms (SNPs) between two randomly sampled isolates. A genetic distance matrix for a set of sampled isolates can be calculated with the gd() function, and visualized with plotdistmat().</p>
        <fig id="pone.0129745.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Genomic diversity in a population undergoing bottlenecks.</title>
            <p>Expected diversity within a population undergoing bottlenecks of size 2 at times 1000 and 2000. A total of 100 populations were simulated over 3000 generations, starting with a single genotype. The black line indicates the mean diversity of the simulations, with the shaded blue area representing the central 95% quantile. Figure plotted using the diversity.range() function.</p>
          </caption>
          <graphic xlink:href="pone.0129745.g003"/>
        </fig>
        <p><xref rid="pone.0129745.g004" ref-type="fig">Fig 4</xref> shows a simulated outbreak occurring in an example population with heterogeneous mixing, visualized with the plotoutbreak() and plotnetwork() functions. Real epidemiological and genomic data may also be visualized with these functions.</p>
        <fig id="pone.0129745.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Simulated epidemic and genomic sampling in a heterogeneously-mixing population.</title>
            <p>(A) The contact network of the population, individuals represented by nodes, and contacts by directed edges. (B) Simulated routes of transmission (directed edges) in this population, where the disease is initially introduced in individual 1. (C) The outbreak and genomic sampling over time. Infected individuals are represented by gray rectangles spanning the time from infection to recovery, arrows denote routes of transmission. Every 250 time steps, ten genomes were sampled at random from each infected individual’s hosted pathogen population. Genomes are represented by colored circles, colored according to genetic distance from the first sampled genome in individual 1; red denotes an identical genotype, while colors closer to the blue end of the spectrum denote an increasing genetic distance from this reference genome.</p>
          </caption>
          <graphic xlink:href="pone.0129745.g004"/>
        </fig>
      </sec>
      <sec id="sec009">
        <title>Theoretical distributions</title>
        <p>The theoretical distributions described in the Methods are implemented in <italic>seedy</italic>. The expsnps() function provides the theoretical distribution for the pairwise number of SNPs between two samples, given a mutation rate, time from lineage divergence to observation, and coalescent rate prior to lineage divergence. The time to coalescence can be approximated using the estcoaltime() function, under the assumption that the population size is constant with the exception of bottleneck times, at which the population size is reduced for one generation to <italic>N</italic><sub><italic>B</italic></sub>. The coalescent rate can be estimated as the reciprocal of the time to coalescence (assuming a constant population size), which can then be input into the previous function. <xref rid="pone.0129745.g005" ref-type="fig">Fig 5</xref> shows the theoretical distributions calculated with this approach, compared to the empirical distributions, derived from repeated simulation.</p>
        <fig id="pone.0129745.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Theoretical and empirical distribution of the genetic distance between sampled isolates.</title>
            <p>The plots show the genetic distance distribution between two isolates sampled from a simulated population at time 20000 (left) and between isolates sampled at times 10000 and 20000. Empirical distributions were calculated from twenty simulated populations, and 500 sampled isolates at each sampling time, under population size 2500 and mutation rate 0.0005.</p>
          </caption>
          <graphic xlink:href="pone.0129745.g005"/>
        </fig>
        <p>These functions can be useful to test hypotheses of person-to-person transmission by comparing true genetic distance observations to their theoretical distributions. We considered individuals in the simulated outbreak shown in <xref rid="pone.0129745.g004" ref-type="fig">Fig 4</xref>. Taking a single sample from cases 2 and 8, we observe a genetic distance of 8 SNPs. This may then be compared to the theoretical distribution–samples taken in this setting would be expected to follow the distribution shown in <xref rid="pone.0129745.s001" ref-type="supplementary-material">S1 Fig</xref>, in the absence of selective pressure. Since the observed distance falls within the 5% extreme tail of this distribution, we can reject the possibility of direct transmission at this probability level.</p>
      </sec>
      <sec id="sec010">
        <title>Transmission route identification</title>
        <p>Based on the theoretical genetic distance distributions, one can assess the likelihood of direct transmission between any pair of individuals based on observed genomic data. All possible transmission pairs can be assessed, and the posterior probability for each potential transmission link can be calculated. The function transroutes() provides the likelihood and posterior probability of transmission between each pair of individuals, as well as the maximum posterior probability source for each individual.</p>
        <p>Using genomic data generated from the simulated outbreak shown in <xref rid="pone.0129745.g004" ref-type="fig">Fig 4</xref>, we attempted to reconstruct the true transmission network using this approach. The maximum posterior estimates identified 77% of the true infection routes (<xref rid="pone.0129745.s002" ref-type="supplementary-material">S2 Fig</xref>), performing better than selecting the host with the closest genotype as source. While this method requires knowledge of infection times and a specified model of within-host dynamics, previous work has demonstrated that using this approach could identify transmission routes more successfully than other existing approaches [<xref rid="pone.0129745.ref028" ref-type="bibr">28</xref>].</p>
        <p>Ruling out all possible sampled hosts as potential sources of infection can suggest the importation of the disease from outside the community, or unsampled intermediate transmission links. We simulated evolutionary dynamics on top of a pre-specified transmission tree, including importations, using the simfixoutbreak() function (<xref rid="pone.0129745.g006" ref-type="fig">Fig 6A</xref>). While a large degree of uncertainty was evident among members of each connected transmission tree, all between-tree transmission links were rejected at the 95% confidence level (<xref rid="pone.0129745.g006" ref-type="fig">Fig 6B</xref>), clearly identifying the group structure.</p>
        <fig id="pone.0129745.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Evolutionary dynamics and estimated routes of infection on a disconnected transmission tree.</title>
            <p>We simulated evolutionary dynamics on top of a pre-specified transmission tree, in which three cases are imported to the community under observation. (A) Genomes are represented by colored circles, colored according to genetic distance from the first sampled genome in individual 1; red denotes an identical genotype, while colors closer to the blue end of the spectrum denote an increasing genetic distance from this reference genome. The expected genetic distance between imported cases was 12 SNPs. (B) Estimated routes of infection. We assumed that recovery times were not observed, such that any previously infected host could be the source of infection at the time of transmission. Routes with posterior probability &lt; 0.05 are not shown. This network diagram was plotted using the igraph package [<xref rid="pone.0129745.ref032" ref-type="bibr">32</xref>].</p>
          </caption>
          <graphic xlink:href="pone.0129745.g006"/>
        </fig>
      </sec>
      <sec id="sec011">
        <title>SNP frequency vs. error</title>
        <p>While it is of interest to estimate the amount of diversity accumulating in a particular population, of practical importance is the number of mutations which are likely to be detected in a deep sequencing project. Low coverage can mean that low frequency SNPs will not be detected, while sequencing errors can result in false positives. The plotobservedsnps() function displays the expected frequency of the most polymorphic sites under a proposed deep sequencing project with a given coverage and per-site error level (<xref rid="pone.0129745.g007" ref-type="fig">Fig 7</xref>). This can indicate the expected number of SNPs of intermediate frequency (iSNPs), the number of mutations which have reached fixation in the population, as well as the baseline of polymorphic sites created by sequencing error.</p>
        <fig id="pone.0129745.g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0129745.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <title>Frequency of polymorphic sites over time from simulated data.</title>
            <p>A population of equilibrium size 10,000 with a 100kb genome was generated over 15,000 generations using the simulatepopulation() function. The top row of plots, generated with the plotobservedsnps() function, show the expected frequency of polymorphisms under a deep sequencing project with an average 50x coverage and 0.1% per site error rate. All polymorphisms present at each time point are ordered by frequency, and plotted, together with 95% confidence intervals. The red line represents binomially-distributed polymorphisms observed via sequencing error. Polymorphisms with intermediate frequency (iSNPs) can be seen to move towards fixation of the time course, with one polymorphism reaching fixation before time 10,000. The bottom row shows the number of polymorphisms at each frequency level, generated using the plotsnpfreq() function.</p>
          </caption>
          <graphic xlink:href="pone.0129745.g007"/>
        </fig>
        <sec id="sec012">
          <title>Computational performance</title>
          <p>The time required to simulate an outbreak depends on the size of the initial susceptible population, the pathogen mutation rate and the within-host pathogen population dynamics. We timed outbreak simulations under a range of different parameter settings (<xref rid="pone.0129745.s003" ref-type="supplementary-material">S3 Fig</xref>). Since generating the exact dynamics of multiple independent pathogen populations is extremely computationally intensive, outbreak simulation can be time-consuming in large, well-connected populations. Simulating outbreaks in a population of 100 could take approximately 10 minutes with a high mutation rate, considerably longer than an equivalent outbreak simulation in the R package <italic>outbreaker</italic> [<xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>], which simulates such outbreaks in less than a minute (See <xref rid="pone.0129745.s005" ref-type="supplementary-material">S1 Table</xref> for a comparison between <italic>seedy</italic> and <italic>outbreaker</italic>). However, unlike <italic>outbreaker</italic>, our software accounts for within-host pathogen population dynamics, allowing carriage of multiple genotypes, and various sampling strategies, and can generate multiple samples for each host.</p>
        </sec>
      </sec>
    </sec>
    <sec sec-type="conclusions" id="sec013">
      <title>Conclusions</title>
      <p>Our software represents the first highly accessible and flexible framework to simulate within- and between-host pathogen evolution during a communicable disease outbreak. While we are not aware of any existing software which performs comparable simulation and analysis, the R package <italic>outbreaker</italic> [<xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>], while created primarily for the purpose of transmission network inference, does share some similarities. We compare the main features of <italic>seedy</italic> and <italic>outbreaker</italic> in <xref rid="pone.0129745.s005" ref-type="supplementary-material">S1 Table</xref>. Our package offers considerably greater flexibility for data simulation by allowing within-host diversity, flexible sampling strategies, variable transmission bottleneck size, generation of deep-sequence samples and specification of arbitrary transmission trees. The <italic>seedy</italic> package contains functions to calculate the distribution of genetic distance between any two isolates, and to assess transmission hypotheses, given a set of genomic samples. The simulation of individual-level evolutionary dynamics is computationally intensive, and large outbreaks with high mutation rates may take a number of minutes to simulate in <italic>seedy</italic>. Small outbreaks (&lt;100) are currently–and are likely to remain–the most common setting for investigations into person-to-person transmission using densely sampled genomic data. As the outbreak under consideration becomes larger, near-complete sampling is more challenging to obtain, and interest typically shifts to population-level rather than individual-level dynamics (eg. geographic spread between communities), at which point, within-host diversity becomes less significant. For such studies, population-level simulation methods (eg. [<xref rid="pone.0129745.ref011" ref-type="bibr">11</xref>]) provide a suitable and less computationally intensive alternative.</p>
      <p>There are several directions in which the package could be extended in the future. Non-neutral evolution could be modeled by assigning mutations a selection coefficient. Recombination is an important source of bacterial diversification, and could be incorporated in the simulation of evolutionary dynamics. However, in the relative short-term, such as the duration of a single outbreak, this effect may only be of minor importance. The model of pathogen birth/death used in simulations is more suited to bacteria, rather than viruses, and incorporation of viral burst dynamics cannot currently be implemented. However, with the option to specify a growth model, one can at least match the expected pathogen population to known viral load curves if required. It would also be possible to include more complex mutation scenarios, such as indels and mutations accumulating at different frequencies in different portions of the genome. While outbreaks may currently be simulated under SIR dynamics in a heterogeneously mixing population, and transmission trees generated under more complex models may be imported, it would be possible for future versions of <italic>seedy</italic> to simulate alternative epidemic models. This could include incorporating a non-infectious stage of infection (SEIR model), or a return to susceptibility after recovery (SIRS model).</p>
      <p>Our package is a useful resource for those aiming to investigate disease transmission and pathogen evolution during an outbreak, and may also provide a useful teaching tool. Sampling and sequencing is typically limited by financial restraints and resource capacity, making the choice of sampling strategy crucial. Datasets can be simulated using our package under plausible parameter values, which may be used to assess the viability of the intended analysis, and to determine the level of sampling required to adequately measure the expected within- and between-host diversity. Simulations can indicate the extent of unobserved diversity likely to exist within-host, which is often overlooked in studies. Several studies consider only a single sample from infected hosts, effectively ignoring within-host diversity. Furthermore, simulating outbreaks may be useful to test hypotheses on pathogen carriage and transmission–for instance, it is commonly assumed for many communicable diseases that a single genotype is transmitted at the point of infection [<xref rid="pone.0129745.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0129745.ref010" ref-type="bibr">10</xref>], although recent experience from genome sequencing studies suggest that this is often not the case [<xref rid="pone.0129745.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0129745.ref030" ref-type="bibr">30</xref>, <xref rid="pone.0129745.ref031" ref-type="bibr">31</xref>]. Simulating within- and between-host diversity under a larger transmission bottleneck can demonstrate whether similar patterns can emerge under alternate hypotheses. Also, simulation can distinguish whether within-host variants resulted from growth from a single recent common ancestor or were more likely the result of superinfection with one or more strains of the same species. Our package offers a flexible framework in which to explore evolutionary and epidemic dynamics.</p>
    </sec>
    <sec sec-type="supplementary-material" id="sec014">
      <title>Supporting Information</title>
      <supplementary-material content-type="local-data" id="pone.0129745.s001">
        <label>S1 Fig</label>
        <caption>
          <title>Probability distribution for the genetic distance between samples taken from patients 2 and 8, as depicted in <xref rid="pone.0129745.g002" ref-type="fig">Fig 2</xref>, under the assumption that direct transmission occurred.</title>
          <p>Simulated genomic samples differed by 8 SNPs, falling into the 5% extreme tail of this distribution (shown in grey), allowing direct transmission to be ruled out to this probability level.</p>
          <p>(TIF)</p>
        </caption>
        <media xlink:href="pone.0129745.s001.tif">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="pone.0129745.s002">
        <label>S2 Fig</label>
        <caption>
          <title>The true transmission network (top left), corresponding to the outbreak shown in <xref rid="pone.0129745.g002" ref-type="fig">Fig 2</xref>.</title>
          <p>The network was estimated based on simulated genomic samples using the transroutes() function, and the estimated network weighted by posterior probability (top right) and the maximum likelihood transmission routes (bottom left) are shown. For comparison, the network estimated under the assumption that the host carrying the closest genotype is the source of infection is also shown (bottom right).</p>
          <p>(TIF)</p>
        </caption>
        <media xlink:href="pone.0129745.s002.tif">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="pone.0129745.s003">
        <label>S3 Fig</label>
        <caption>
          <title>Computational times for simulating an outbreak under a variety of parameter settings (initial number susceptible population, mutation rate) using the function simulateoutbreak().</title>
          <p>Computer specifications: 2.7 GHz Intel Core i5, memory 8GB.</p>
          <p>(TIF)</p>
        </caption>
        <media xlink:href="pone.0129745.s003.tif">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="pone.0129745.s004">
        <label>S1 File</label>
        <caption>
          <title>Zipped file containing seedy v1.2, the version of the package at the time of composing the manuscript.</title>
          <p>The latest version is available to download from CRAN [<xref rid="pone.0129745.ref021" ref-type="bibr">21</xref>]. Additionally, examples.r, an R script used to generate the figures in this manuscript.</p>
          <p>(ZIP)</p>
        </caption>
        <media xlink:href="pone.0129745.s004.zip">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="pone.0129745.s005">
        <label>S1 Table</label>
        <caption>
          <title>Comparison of features in <italic>seedy</italic> and <italic>outbreaker</italic>.</title>
          <p>Both R packages are publicly available on CRAN, and offer simulation of genomic and epidemiological data during infectious disease outbreaks, as well as functions to infer transmission routes.</p>
          <p>(DOC)</p>
        </caption>
        <media xlink:href="pone.0129745.s005.doc">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We wish to thank Dr. M. Lipsitch and Dr. W. P. Hanage for constructive and valuable input during software development and manuscript preparation.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pone.0129745.ref001">
        <label>1</label>
        <mixed-citation publication-type="journal"><name><surname>Didelot</surname><given-names>X</given-names></name>, <name><surname>Gardy</surname><given-names>J</given-names></name>, <name><surname>Colijn</surname><given-names>C</given-names></name>. <article-title>Bayesian analysis of infectious disease transmission from whole genome sequence data</article-title>. <source>Mol Biol Evol</source>. <year>2014</year>;<volume>31</volume>(<issue>7</issue>):<fpage>1869</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msu121">10.1093/molbev/msu121</ext-link></comment>
<pub-id pub-id-type="pmid">24714079</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref002">
        <label>2</label>
        <mixed-citation publication-type="journal"><name><surname>Gire</surname><given-names>SK</given-names></name>, <name><surname>Goba</surname><given-names>A</given-names></name>, <name><surname>Andersen</surname><given-names>KG</given-names></name>, <name><surname>Sealfon</surname><given-names>RSG</given-names></name>, <name><surname>Park</surname><given-names>DJ</given-names></name>, <name><surname>Kanneh</surname><given-names>L</given-names></name>, <etal>et al</etal>
<article-title>Genomic surveillance elucidates Ebola virus origin and transmission during the 2014 outbreak</article-title>. <source>Science</source>. <year>2014</year>;<volume>345</volume>(<issue>6202</issue>):<fpage>1369</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1259657">10.1126/science.1259657</ext-link></comment>
<pub-id pub-id-type="pmid">25214632</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref003">
        <label>3</label>
        <mixed-citation publication-type="journal"><name><surname>Reuter</surname><given-names>S</given-names></name>, <name><surname>Harrison</surname><given-names>TG</given-names></name>, <name><surname>Köser</surname><given-names>CU</given-names></name>, <name><surname>Ellington</surname><given-names>MJ</given-names></name>, <name><surname>Smith</surname><given-names>GP</given-names></name>, <name><surname>Parkhill</surname><given-names>J</given-names></name>, <etal>et al</etal>
<article-title>A pilot study of rapid whole-genome sequencing for the investigation of a Legionella outbreak</article-title>. <source>BMJ Open</source>. <year>2013</year>;<volume>3</volume>(<issue>1</issue>):<fpage>e002175</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1136/bmjopen-2012-002175">10.1136/bmjopen-2012-002175</ext-link></comment>
<pub-id pub-id-type="pmid">23306006</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref004">
        <label>4</label>
        <mixed-citation publication-type="journal"><name><surname>Török</surname><given-names>ME</given-names></name>, <name><surname>Reuter</surname><given-names>S</given-names></name>, <name><surname>Bryant</surname><given-names>JM</given-names></name>, <name><surname>Köser</surname><given-names>CU</given-names></name>, <name><surname>Stinchcombe</surname><given-names>SV</given-names></name>, <name><surname>Nazareth</surname><given-names>B</given-names></name>, <etal>et al</etal>
<article-title>Rapid whole-genome sequencing for investigation of a suspected Tuberculosis outbreak</article-title>. <source>J Clin Microbiol</source>. <year>2013</year>;<volume>51</volume>(<issue>2</issue>):<fpage>611</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JCM.02279-12">10.1128/JCM.02279-12</ext-link></comment>
<pub-id pub-id-type="pmid">23175259</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref005">
        <label>5</label>
        <mixed-citation publication-type="journal"><name><surname>Mwangi</surname><given-names>MM</given-names></name>, <name><surname>Wu</surname><given-names>SW</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Sieradzki</surname><given-names>K</given-names></name>, <name><surname>de Lencastre</surname><given-names>H</given-names></name>, <name><surname>Richardson</surname><given-names>P</given-names></name>, <etal>et al</etal>
<article-title>Tracking the in vivo evolution of multidrug resistance in Staphylococcus aureus by whole-genome sequencing</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2007</year>;<volume>104</volume>(<issue>22</issue>):<fpage>9451</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="pmid">17517606</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref006">
        <label>6</label>
        <mixed-citation publication-type="journal"><name><surname>Cottam</surname><given-names>EM</given-names></name>, <name><surname>Thébaud</surname><given-names>G</given-names></name>, <name><surname>Wadsworth</surname><given-names>J</given-names></name>, <name><surname>Gloster</surname><given-names>J</given-names></name>, <name><surname>Mansley</surname><given-names>L</given-names></name>, <name><surname>Paton</surname><given-names>DJ</given-names></name>, <etal>et al</etal>
<article-title>Integrating genetic and epidemiological data to determine transmission pathways of foot-and-mouth disease virus</article-title>. <source>Proc R Soc B</source>. <year>2008</year>;<volume>275</volume>(<issue>1637</issue>):<fpage>887</fpage>–<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2007.1442">10.1098/rspb.2007.1442</ext-link></comment>
<pub-id pub-id-type="pmid">18230598</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref007">
        <label>7</label>
        <mixed-citation publication-type="journal"><name><surname>Ypma</surname><given-names>RJF</given-names></name>, <name><surname>Bataille</surname><given-names>AMA</given-names></name>, <name><surname>Stegeman</surname><given-names>A</given-names></name>, <name><surname>Koch</surname><given-names>G</given-names></name>, <name><surname>Wallinga</surname><given-names>J</given-names></name>, <name><surname>van Ballegooijen</surname><given-names>WM</given-names></name>. <article-title>Unravelling transmission trees of infectious diseases by combining genetic and epidemiological data</article-title>. <source>Proc R Soc B</source>. <year>2012</year>;<volume>279</volume>:<fpage>444</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2011.0913">10.1098/rspb.2011.0913</ext-link></comment>
<pub-id pub-id-type="pmid">21733899</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref008">
        <label>8</label>
        <mixed-citation publication-type="journal"><name><surname>Jombart</surname><given-names>T</given-names></name>, <name><surname>Cori</surname><given-names>A</given-names></name>, <name><surname>Didelot</surname><given-names>X</given-names></name>, <name><surname>Cauchemez</surname><given-names>S</given-names></name>, <name><surname>Fraser</surname><given-names>C</given-names></name>, <name><surname>Ferguson</surname><given-names>N</given-names></name>. <article-title>Bayesian Reconstruction of Disease Outbreaks by Combining Epidemiologic and Genomic Data</article-title>. <source>PLoS Comp Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>1</issue>):<fpage>e1003457</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003457">10.1371/journal.pcbi.1003457</ext-link></comment>
<pub-id pub-id-type="pmid">24465202</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref009">
        <label>9</label>
        <mixed-citation publication-type="journal"><name><surname>Morelli</surname><given-names>MJ</given-names></name>, <name><surname>Thébaud</surname><given-names>G</given-names></name>, <name><surname>Chadœuf</surname><given-names>J</given-names></name>, <name><surname>King</surname><given-names>DP</given-names></name>, <name><surname>Haydon</surname><given-names>DT</given-names></name>, <name><surname>Soubeyrand</surname><given-names>S</given-names></name>. <article-title>A Bayesian Inference Framework to Reconstruct Transmission Trees Using Epidemiological and Genetic Data</article-title>
<source>PLoS Comp Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e1002768</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002768">10.1371/journal.pcbi.1002768</ext-link></comment>
<pub-id pub-id-type="pmid">23166481</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref010">
        <label>10</label>
        <mixed-citation publication-type="journal"><name><surname>Ypma</surname><given-names>RJF</given-names></name>, <name><surname>van Ballegooijen</surname><given-names>WM</given-names></name>, <name><surname>Wallinga</surname><given-names>J</given-names></name>. <article-title>Relating phylogenetic trees to transmission trees of infectious disease outbreaks</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>195</volume>(<issue>3</issue>):<fpage>1055</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.113.154856">10.1534/genetics.113.154856</ext-link></comment>
<pub-id pub-id-type="pmid">24037268</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref011">
        <label>11</label>
        <mixed-citation publication-type="journal"><name><surname>Koelle</surname><given-names>K</given-names></name>, <name><surname>Khatri</surname><given-names>P</given-names></name>, <name><surname>Kamradt</surname><given-names>M</given-names></name>, <name><surname>Kepler</surname><given-names>TB</given-names></name>. <article-title>A two-tiered model for simulating the ecological and evolutionary dynamics of rapidly evolving viruses, with an application to influenza</article-title>. <source>J R Soc Interface</source>. <year>2010</year>;<volume>7</volume>(<issue>50</issue>):<fpage>1257</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2010.0007">10.1098/rsif.2010.0007</ext-link></comment>
<pub-id pub-id-type="pmid">20335193</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref012">
        <label>12</label>
        <mixed-citation publication-type="journal"><name><surname>Koelle</surname><given-names>K</given-names></name>, <name><surname>Rasmussen</surname><given-names>DA</given-names></name>. <article-title>Rates of coalescence for common epidemiological models at equilibrium</article-title>. <source>J R Soc Interface</source>. <year>2012</year>;<volume>9</volume>(<issue>70</issue>):<fpage>997</fpage>–<lpage>1007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2011.0495">10.1098/rsif.2011.0495</ext-link></comment>
<pub-id pub-id-type="pmid">21920961</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref013">
        <label>13</label>
        <mixed-citation publication-type="journal"><name><surname>Golubchik</surname><given-names>T</given-names></name>, <name><surname>Batty</surname><given-names>EM</given-names></name>, <name><surname>Miller</surname><given-names>RR</given-names></name>, <name><surname>Farr</surname><given-names>H</given-names></name>, <name><surname>Young</surname><given-names>BC</given-names></name>, <name><surname>Larner-Svensson</surname><given-names>H</given-names></name>, <etal>et al</etal>
<article-title>Within-Host Evolution of Staphylococcus aureus during Asymptomatic Carriage</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e61319</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0061319">10.1371/journal.pone.0061319</ext-link></comment>
<pub-id pub-id-type="pmid">23658690</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref014">
        <label>14</label>
        <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>K</given-names></name>, <name><surname>Fyson</surname><given-names>N</given-names></name>, <name><surname>Cohen</surname><given-names>T</given-names></name>, <name><surname>Fraser</surname><given-names>C</given-names></name>, <name><surname>Colijn</surname><given-names>C</given-names></name>. <article-title>How the dynamics and structure of sexual contact networks shape pathogen phylogenies</article-title>. <source>PLoS Comp Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>6</issue>):<fpage>e1003105</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003105">10.1371/journal.pcbi.1003105</ext-link></comment>
<pub-id pub-id-type="pmid">23818840</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref015">
        <label>15</label>
        <mixed-citation publication-type="journal"><name><surname>Leventhal</surname><given-names>GE</given-names></name>, <name><surname>Kouyos</surname><given-names>R</given-names></name>, <name><surname>Stadler</surname><given-names>T</given-names></name>, <name><surname>von Wyl</surname><given-names>V</given-names></name>, <name><surname>Yerly</surname><given-names>S</given-names></name>, <name><surname>Böni</surname><given-names>J</given-names></name>, <etal>et al</etal>
<article-title>Inferring Epidemic Contact Structure from Phylogenetic Trees</article-title>. <source>PLoS Comp Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002413</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002413">10.1371/journal.pcbi.1002413</ext-link></comment>
<pub-id pub-id-type="pmid">22412361</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref016">
        <label>16</label>
        <mixed-citation publication-type="other">Jenness SM, Goodreau SM, Morris M. EpiModel: Mathematical Modeling of Infectious Disease. The StatNet Project. Available: <ext-link ext-link-type="uri" xlink:href="http://www.statnet.org/">http://www.statnet.org/</ext-link>. 2014.</mixed-citation>
      </ref>
      <ref id="pone.0129745.ref017">
        <label>17</label>
        <mixed-citation publication-type="journal"><name><surname>Schliep</surname><given-names>KP</given-names></name>. <article-title>phangorn: Phylogenetic analysis in R</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>4</issue>):<fpage>592</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq706">10.1093/bioinformatics/btq706</ext-link></comment>
<pub-id pub-id-type="pmid">21169378</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref018">
        <label>18</label>
        <mixed-citation publication-type="journal"><name><surname>Long</surname><given-names>SW</given-names></name>, <name><surname>Beres</surname><given-names>SB</given-names></name>, <name><surname>Olsen</surname><given-names>RJ</given-names></name>, <name><surname>Musser</surname><given-names>JM</given-names></name>. <article-title>Absence of Patient-to-Patient Intrahospital Transmission of Staphylococcus aureus as Determined by Whole-Genome Sequencing</article-title>
<source>mBio</source>. <year>2014</year>;<volume>5</volume>(<issue>5</issue>):<fpage>e01692</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/mBio.01692-14">10.1128/mBio.01692-14</ext-link></comment>
<pub-id pub-id-type="pmid">25293757</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref019">
        <label>19</label>
        <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>J</given-names></name>, <name><surname>Golubchik</surname><given-names>T</given-names></name>, <name><surname>Cole</surname><given-names>K</given-names></name>, <name><surname>Wilson</surname><given-names>D</given-names></name>, <name><surname>Crook</surname><given-names>D</given-names></name>, <name><surname>Thwaites</surname><given-names>G</given-names></name>, <etal>et al</etal>
<article-title>Whole-genome sequencing shows that patient-to-patient transmission rarely accounts for acquisition of Staphylococcus aureus in an intensive care unit</article-title>. <source>Clin Infect Dis</source>. <year>2014</year>;<volume>58</volume>(<issue>5</issue>):<fpage>609</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cid/cit807">10.1093/cid/cit807</ext-link></comment>
<pub-id pub-id-type="pmid">24336829</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref020">
        <label>20</label>
        <mixed-citation publication-type="book"><collab>R Core Team</collab>. <chapter-title>R: A Language and Environment for Statistical Computing</chapter-title>
<publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc> Available: <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link>. <year>2014</year>.</mixed-citation>
      </ref>
      <ref id="pone.0129745.ref021">
        <label>21</label>
        <mixed-citation publication-type="other">CRAN. CRAN—Package seedy <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/seedy/2015">http://cran.r-project.org/web/packages/seedy/2015</ext-link>. Available: <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/seedy/">http://cran.r-project.org/web/packages/seedy/</ext-link>. Accessed 15 April 2015.</mixed-citation>
      </ref>
      <ref id="pone.0129745.ref022">
        <label>22</label>
        <mixed-citation publication-type="journal"><name><surname>Maddison</surname><given-names>DR</given-names></name>, <name><surname>Swofford</surname><given-names>DL</given-names></name>, <name><surname>Maddison</surname><given-names>WP</given-names></name>. <article-title>NEXUS: An extensible file format for systematic information</article-title>. <source>Syst Biol</source>. <year>1997</year>;<volume>46</volume>(<issue>4</issue>):<fpage>590</fpage>–<lpage>621</lpage>. <pub-id pub-id-type="pmid">11975335</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref023">
        <label>23</label>
        <mixed-citation publication-type="journal"><name><surname>Kermack</surname><given-names>WO</given-names></name>, <name><surname>McKendrick</surname><given-names>AG</given-names></name>. <article-title>A Contribution to the Mathematical Theory of Epidemics</article-title>. <source>Proceedings of the Royal Society</source>. <year>1927</year>;<volume>115</volume>(<issue>772</issue>):<fpage>700</fpage>–<lpage>21</lpage>.</mixed-citation>
      </ref>
      <ref id="pone.0129745.ref024">
        <label>24</label>
        <mixed-citation publication-type="journal"><name><surname>Bansal</surname><given-names>S</given-names></name>, <name><surname>Grenfell</surname><given-names>BT</given-names></name>, <name><surname>Meyers</surname><given-names>LA</given-names></name>. <article-title>When individual behaviour matters: homogeneous and network models in epidemiology</article-title>. <source>J R Soc Interface</source>. <year>2007</year>;<volume>4</volume>(<issue>16</issue>):<fpage>879</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="pmid">17640863</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref025">
        <label>25</label>
        <mixed-citation publication-type="journal"><name><surname>Bouckaert</surname><given-names>R</given-names></name>, <name><surname>Heled</surname><given-names>J</given-names></name>, <name><surname>Kühnert</surname><given-names>D</given-names></name>, <name><surname>Vaughan</surname><given-names>T</given-names></name>, <name><surname>Wu C-</surname><given-names>H</given-names></name>, <name><surname>Xie</surname><given-names>D</given-names></name>, <etal>et al</etal>
<article-title>BEAST 2: A Software Platform for Bayesian Evolutionary Analysis</article-title>. <source>PLoS Comp Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003537</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003537">10.1371/journal.pcbi.1003537</ext-link></comment>
<pub-id pub-id-type="pmid">24722319</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref026">
        <label>26</label>
        <mixed-citation publication-type="book"><name><surname>Swofford</surname><given-names>DL.</given-names></name>
<chapter-title>PAUP*. Phylogenetic Analysis Using Parsimony</chapter-title>
<publisher-name>Sinauer Associates</publisher-name>, <publisher-loc>Sunderland, MA</publisher-loc>; <year>2003</year>.</mixed-citation>
      </ref>
      <ref id="pone.0129745.ref027">
        <label>27</label>
        <mixed-citation publication-type="journal"><name><surname>Paradis</surname><given-names>E</given-names></name>, <name><surname>Claude</surname><given-names>J</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>APE: Analyses of phylogenetics and evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>90</lpage>. <pub-id pub-id-type="pmid">14734327</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref028">
        <label>28</label>
        <mixed-citation publication-type="journal"><name><surname>Worby</surname><given-names>CJ</given-names></name>, <name><surname>Chang H-</surname><given-names>H</given-names></name>, <name><surname>Hanage</surname><given-names>WP</given-names></name>, <name><surname>Lipsitch</surname><given-names>M</given-names></name>. <article-title>The distribution of pairwise genetic distances: a tool for investigating disease transmission</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>198</volume>(<issue>4</issue>):<fpage>1395</fpage>–<lpage>404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1534/genetics.114.171538">10.1534/genetics.114.171538</ext-link></comment>
<pub-id pub-id-type="pmid">25313129</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref029">
        <label>29</label>
        <mixed-citation publication-type="journal"><name><surname>Watterson</surname><given-names>GA</given-names></name>. <article-title>On the number of segregating sites in genetic models without recombination</article-title>. <source>Theor Popul Biol</source>. <year>1975</year>;<volume>7</volume>(<issue>2</issue>):<fpage>256</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="pmid">1145509</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref030">
        <label>30</label>
        <mixed-citation publication-type="journal"><name><surname>Somboonna</surname><given-names>N</given-names></name>, <name><surname>Wan</surname><given-names>R</given-names></name>, <name><surname>Ojcius</surname><given-names>DM</given-names></name>, <name><surname>Pettengill</surname><given-names>MA</given-names></name>, <name><surname>Joseph</surname><given-names>SJ</given-names></name>, <name><surname>Chang</surname><given-names>A</given-names></name>, <etal>et al</etal>
<article-title>Hypervirulent Chlamydia trachomatis clinical strain is a recombinant between lymphogranuloma venereum (L(2)) and D lineages</article-title>. <source>mBio</source>. <year>2011</year>;<volume>2</volume>(<issue>3</issue>):<fpage>e00042</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/mBio.00042-11">10.1128/mBio.00042-11</ext-link></comment>
<pub-id pub-id-type="pmid">21610121</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref031">
        <label>31</label>
        <mixed-citation publication-type="journal"><name><surname>Ågren</surname><given-names>J</given-names></name>, <name><surname>Finn</surname><given-names>M</given-names></name>, <name><surname>Bengtsson</surname><given-names>B</given-names></name>, <name><surname>Segerman</surname><given-names>B</given-names></name>. <article-title>Microevolution during an Anthrax Outbreak Leading to Clonal Heterogeneity and Penicillin Resistance</article-title>
<source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>2</issue>):<fpage>e89112</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0089112">10.1371/journal.pone.0089112</ext-link></comment>
<pub-id pub-id-type="pmid">24551231</pub-id></mixed-citation>
      </ref>
      <ref id="pone.0129745.ref032">
        <label>32</label>
        <mixed-citation publication-type="other">Csardi G, Nepusz T. The igraph software package for complex network research. InterJournal. 2006;Complex Systems:1695.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>

